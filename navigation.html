<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Field Navigation Guide ‚Äî Compass, Map, and Natural North</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="assets/css/mobile-backgrounds.css">
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
  <meta name="theme-color" content="#0a0e17">
  <meta name="description" content="Survival navigation without GPS: compass basics, map reading, triangulation, and finding north from nature (sun, stars, shadow-stick).">
  <meta name="author" content="Hazem ElBatawy">
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S9H098RFW9"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-S9H098RFW9');
  </script>
  
  <!-- Embedded PDF Styles -->
  <style>
    /* Background slideshow setup */
    .bg-slideshow {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
      background-color: #0a0e17;
    }
    
    .bg-slideshow img {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
      opacity: 0;
      transition: opacity 2s ease-in-out;
      pointer-events: none;
    }
    
    .bg-slideshow img.active {
      opacity: 0.5;
    }
    
    /* Content styling for better readability */
    main {
      position: relative;
      z-index: 1;
      background: rgba(11, 18, 32, 0.7);
      backdrop-filter: blur(8px);
      border-radius: 8px;
      margin: 20px auto;
      padding: 20px;
      border: 1px solid rgba(154, 230, 180, 0.1);
    }
    
    .site-header {
      background: rgba(8, 18, 33, 0.85);
      backdrop-filter: blur(10px);
    }
    
    h1, h2, h3, h4 {
      color: #fff;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
    }
    
    .handbook-section {
      margin-top: 30px !important; 
      padding: 20px !important; 
      background: rgba(255,255,255,0.1) !important; 
      border-radius: 8px !important; 
      border: 1px solid rgba(255,255,255,0.2) !important;
    }
    
    .handbook-section h3 {
      color: #fff !important; 
      margin-bottom: 15px !important; 
      display: flex !important; 
      align-items: center !important;
      font-size: 1.4em !important;
    }
    
    .handbook-section p {
      color: #ddd !important; 
      margin-bottom: 20px !important; 
      line-height: 1.5 !important;
    }
    
    .pdf-container iframe {
      width: 100% !important; 
      height: 600px !important; 
      border: 1px solid #ccc !important; 
      border-radius: 4px !important; 
      background: #fff !important;
    }
    
    .handbook-actions {
      display: flex !important; 
      gap: 15px !important; 
      flex-wrap: wrap !important; 
      align-items: center !important;
    }
    
    .handbook-actions a, .handbook-actions button {
      display: inline-flex !important; 
      align-items: center !important; 
      padding: 12px 20px !important; 
      text-decoration: none !important; 
      border-radius: 6px !important; 
      font-weight: bold !important; 
      transition: background 0.3s !important;
      border: none !important;
      cursor: pointer !important;
      font-family: inherit !important;
      font-size: 14px !important;
    }
    
    .handbook-actions a:first-child { background: #4CAF50 !important; color: white !important; }
    .handbook-actions a:nth-child(2) { background: #2196F3 !important; color: white !important; }
    .handbook-actions button { background: #FF9800 !important; color: white !important; }
    
    .handbook-actions a:hover:first-child { background: #45a049 !important; }
    .handbook-actions a:hover:nth-child(2) { background: #1976D2 !important; }
    .handbook-actions button:hover { background: #F57C00 !important; }
    
    /* Mobile responsive styles */
    @media (max-width: 768px) {
      .handbook-section {
        margin: 20px -10px 30px -10px !important;
        padding: 15px !important;
        border-radius: 0 !important;
      }
      
      .handbook-section h3 {
        font-size: 1.2em !important;
        flex-direction: column !important;
        text-align: center !important;
        gap: 8px !important;
      }
      
      .pdf-container iframe {
        height: 400px !important;
      }
      
      .handbook-actions {
        flex-direction: column !important;
        gap: 10px !important;
      }
      
      .handbook-actions a, .handbook-actions button {
        width: 100% !important;
        justify-content: center !important;
        padding: 15px 20px !important;
        font-size: 16px !important;
      }
    }
    
    /* Very small mobile devices */
    @media (max-width: 480px) {
      .pdf-container iframe {
        height: 300px !important;
      }
      
      .handbook-section {
        margin: 15px -15px 25px -15px !important;
        padding: 12px !important;
      }
    }
    
    /* Enhanced Navigation Styling */
    .site-header {
      background: linear-gradient(135deg, 
        rgba(8, 18, 33, 0.85) 0%, 
        rgba(11, 23, 38, 0.9) 50%, 
        rgba(15, 27, 42, 0.85) 100%);
      backdrop-filter: blur(20px) saturate(180%);
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      border-bottom: 2px solid rgba(154, 230, 180, 0.4);
      border-top: 1px solid rgba(154, 230, 180, 0.2);
      position: relative;
      z-index: 100;
      box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1),
        0 1px 0 rgba(154, 230, 180, 0.3);
    }
    
    .site-header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, 
        rgba(154, 230, 180, 0.08) 0%, 
        transparent 50%, 
        rgba(154, 230, 180, 0.04) 100%);
      pointer-events: none;
      z-index: -1;
    }
    
    .header-nav-links {
      display: flex !important;
      justify-content: center;
      align-items: center;
      gap: 0;
      margin-bottom: 20px;
      padding: 12px 15px;
      background: rgba(10, 14, 23, 0.6);
      backdrop-filter: blur(15px);
      border-radius: 50px;
      border: 1px solid rgba(154, 230, 180, 0.25);
      box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      max-width: 1000px;
      margin: 0 auto 20px auto;
      flex-wrap: wrap;
    }
    
    .header-nav-links a {
      color: #E2E8F0 !important;
      text-decoration: none;
      padding: 10px 16px;
      border-radius: 25px;
      font-weight: 500;
      font-size: 0.9em;
      position: relative;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      white-space: nowrap;
      border: 1px solid transparent;
      flex-shrink: 0;
    }
    
    .header-nav-links a:hover {
      color: #9AE6B4 !important;
      background: rgba(154, 230, 180, 0.15);
      border-color: rgba(154, 230, 180, 0.3);
      transform: translateY(-2px);
      box-shadow: 
        0 8px 25px rgba(154, 230, 180, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }
    
    .header-nav-links a[href*="navigation.html"] {
      color: #9AE6B4 !important;
      background: rgba(154, 230, 180, 0.2);
      border-color: rgba(154, 230, 180, 0.4);
      box-shadow: 
        0 4px 15px rgba(154, 230, 180, 0.25),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }
    
    .site-header h1 {
      font-size: 2.5rem;
      font-weight: 700;
      background: linear-gradient(135deg, #9AE6B4 0%, #E2E8F0 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: none;
      margin: 20px 0 10px 0;
      letter-spacing: -0.5px;
    }
    
    .site-header .subtitle {
      color: #CBD5E0;
      font-size: 1.1rem;
      font-weight: 400;
      margin: 8px 0 15px 0;
      opacity: 0.9;
    }
    
    .site-header .byline {
      color: #9AE6B4;
      font-style: italic;
      font-size: 0.95rem;
      font-weight: 500;
      margin: 10px 0 15px 0;
      opacity: 0.8;
    }
    
    @media (max-width: 768px) {
      .header-nav-links {
        flex-direction: column;
        gap: 8px;
        padding: 20px;
        border-radius: 20px;
      }
      
      .header-nav-links a {
        width: 100%;
        text-align: center;
        padding: 15px;
      }
      
      .site-header h1 {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <!-- Background slideshow for navigation theme -->
  <div class="bg-slideshow">
    <img src="assets/kit-photos/compass/compass survival navigation.jpg" alt="Compass Navigation" class="active" loading="eager" decoding="sync">
    <img src="assets/kit-photos/maps_compass.jpg" alt="Maps and Compass" loading="lazy" decoding="async">
    <img src="assets/kit-photos/map/world-map-dotted.jpg" alt="World Map" loading="lazy" decoding="async">
    <img src="assets/kit-photos/survival/survival one.jpg" alt="Survival Navigation" loading="lazy" decoding="async">
  </div>

  <header class="site-header">
    <div class="wrap">
      <nav class="header-nav-links">
        <a href="index.html" data-i18n="nav.home">Home</a>
        <a href="survival-kit.html" data-i18n="nav.kit">War Survival Kit</a>
        <a href="navigation.html" data-i18n="nav.navigation">Navigation Tutorial</a>
        <a href="egypt.html" data-i18n="nav.egypt">Egypt Map</a>
        <a href="how-to-download-zip.html" data-i18n="nav.downloadHelp">How to Download All PDFs (ZIP)</a>
        <a href="discussion.html" data-i18n="nav.discussion">Discussion</a>
      </nav>
      <h1 data-i18n="navGuide.title">Field Navigation Guide</h1>
      <p class="subtitle" data-i18n="navGuide.subtitle">Navigate without GPS ‚Äî compass, map reading, and natural navigation</p>
      <p class="byline" data-i18n="header.byline">By Hazem ElBatawy</p>
      <div id="lang-switcher"></div>
    </div>
  </header>

  <main class="wrap">
    <article id="nav-guide">
  <p class="lede" data-i18n="navGuide.lede">This tutorial teaches reliable, low-tech navigation. You'll learn how to use a compass and paper map, correct for magnetic declination, triangulate your position, and find north from the sun and stars. These skills work anywhere ‚Äî no batteries required.</p>

      <section class="kit-section" id="compass-basics">
        <div class="kit-header">
          <img src="assets/kit-images/navigation.svg" alt="Navigation Icon" class="kit-image" loading="lazy" decoding="async">
          <h2 data-i18n="navGuide.compassTitle">1) Compass Basics</h2>
        </div>
        <ul class="kit-list">
          <li><strong>Parts</strong>: Baseplate, direction-of-travel arrow, rotating bezel, index line, magnetic needle (red points to magnetic north).</li>
          <li><strong>To take a bearing</strong>:
            <ol>
              <li>Point the direction-of-travel arrow at your target.</li>
              <li>Rotate the bezel until the orienting lines align with the needle ("red in the shed").</li>
              <li>Read the number at the index line ‚Äî that‚Äôs your bearing (¬∞).</li>
            </ol>
          </li>
          <li><strong>Follow a bearing</strong>: Turn until the needle aligns with the orienting arrow again, then walk along the direction-of-travel arrow. Pick distant features to reduce drift.</li>
          <li><strong>Magnetic declination</strong>: The angle between magnetic north and true north. Adjust your bearing by local declination.
            <ul>
              <li>Egypt (Cairo, 2025): approx +3¬∞E (check current value).</li>
              <li>Rule of thumb: <em>True = Magnetic + Easterly declination</em>; <em>True = Magnetic ‚àí Westerly declination</em>.</li>
              <li>Use NOAA‚Äôs calculator to confirm: https://www.ngdc.noaa.gov/geomag/calculators/magcalc.shtml</li>
            </ul>
          </li>
        </ul>
        
        <!-- Real Compass Demonstration -->
        <div class="handbook-section">
          <h3>üß≠ Compass Reading Demonstration</h3>
          <div style="text-align: center; margin: 20px 0;">
            <img src="assets/kit-photos/compass/Real compass.jpeg" 
                 alt="Professional compass showing perfect North alignment" 
                 style="max-width: 400px; width: 100%; height: auto; border-radius: 8px; border: 2px solid rgba(154, 230, 180, 0.3);" 
                 loading="lazy" decoding="async">
          </div>
          <p><strong>Perfect Compass Technique Demonstrated:</strong></p>
          <ul>
            <li><strong>Step 1:</strong> Let the red needle find magnetic North naturally</li>
            <li><strong>Step 2:</strong> Rotate the compass housing to align the needle with "N"</li>
            <li><strong>Step 3:</strong> Read the bearing - this shows exactly 0¬∞ (True North)</li>
            <li><strong>Air-filled compass note:</strong> Wait 20+ seconds for needle to settle completely</li>
          </ul>
          <p><em>This demonstrates professional-grade compass technique with a high-quality air-filled compass. 
          The perfect 0¬∞ North reading shows proper calibration and accurate navigation capability.</em></p>
        </div>
        
        <!-- Embedded Lensatic Compass Handbook -->
        <div class="handbook-section">
          <h3 data-i18n="navGuide.handbookTitle">üìñ Official Lensatic Compass Handbook</h3>
          <p data-i18n="navGuide.handbookDesc">
            Complete technical manual for the military lensatic compass (Model B170249XQ). 
            Includes detailed instructions, maintenance procedures, and advanced navigation techniques.
          </p>
          
          <!-- PDF Access Options -->
          <div class="pdf-container">
            <!-- GitHub Pages Compatible PDF Access -->
            <div class="pdf-access-options" style="background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 25px; text-align: center;">
              <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 20px; gap: 12px;">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="#4CAF50">
                  <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                </svg>
                <h4 style="color: #fff; margin: 0; font-size: 1.3em;">Official Military Compass Manual</h4>
              </div>
              <p style="color: #ddd; margin-bottom: 25px; line-height: 1.5; font-size: 1em;">
                Access the complete B170249XQ Lensatic Compass technical handbook with detailed instructions and maintenance procedures.
              </p>
              
              <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <a href="pdf-viewer.html" 
                   style="background: #4CAF50; color: white; padding: 14px 24px; text-decoration: none; border-radius: 6px; font-weight: bold; display: inline-flex; align-items: center; gap: 8px; transition: background 0.3s;">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z"/>
                  </svg>
                  üìñ View Handbook
                </a>
                
                <a href="B170249XQ_Lensatic_Compass.pdf" 
                   download="Lensatic_Compass_Handbook.pdf"
                   data-i18n="navGuide.downloadHandbook"
                   style="background: #2196F3; color: white; padding: 14px 24px; text-decoration: none; border-radius: 6px; font-weight: bold; display: inline-flex; align-items: center; gap: 8px; transition: background 0.3s;">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"/>
                  </svg>
                  Download Handbook (PDF)
                </a>
                
                <a href="B170249XQ_Lensatic_Compass.pdf" 
                   target="_blank"
                   data-i18n="navGuide.openNewTab"
                   style="background: #FF9800; color: white; padding: 14px 24px; text-decoration: none; border-radius: 6px; font-weight: bold; display: inline-flex; align-items: center; gap: 8px; transition: background 0.3s;">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z"/>
                  </svg>
                  Open in New Tab
                </a>
              </div>
              
              <p style="color: #bbb; margin-top: 20px; font-size: 0.9em; line-height: 1.4;">
                üí° <strong>Tip:</strong> For best experience, use "View Handbook" to access the PDF in a dedicated viewer, or download for offline reading.
              </p>
            </div>
          </div>
        </div>
      </section>

      <section class="kit-section" id="map-reading">
        <h2 data-i18n="navGuide.mapTitle">2) Map Reading & Triangulation</h2>
        <div class="sub-gallery">
          <div class="sub-gallery-item">
            <img src="assets/kit-photos/maps_compass.jpg" alt="Topographic map with compass" class="kit-photo" loading="lazy" decoding="async">
            <p>Orient the map with the compass, then align features.</p>
          </div>
        </div>
        <ul class="kit-list">
          <li><strong>Orient the map</strong>: Place the compass on the map edge; rotate map and compass together until the needle points to the map‚Äôs north (correct for declination).</li>
          <li><strong>Triangulate your position (resection)</strong>:
            <ol>
              <li>Identify two (ideally three) distant, known landmarks on the map.</li>
              <li>Take a field bearing to each landmark, convert to <em>map back-bearings</em> (¬±180¬∞), correct for declination.</li>
              <li>Draw the back-bearings on the map. Their intersection is your location.</li>
            </ol>
          </li>
          <li><strong>Pacing</strong>: Measure your steps per 100 m on flat terrain; use it to track distance in the field.</li>
          <li><strong>Handrails & Catch Features</strong>: Follow linear features (streams, ridgelines) and use obvious boundaries to prevent overshooting.</li>
        </ul>
      </section>

      <section class="kit-section" id="map-wheel">
        <h2>2B) Measuring Distance on a Map (Curvimeter / Map Wheel)</h2>
        <p class="kit-photo-caption">Also called an <em>opisometer</em>, a map wheel lets you trace roads/trails and read their length, then convert using the map scale.</p>
        <div class="sub-gallery">
          <div class="sub-gallery-item">
            <img src="assets/kit-images/map-wheel.svg" alt="Map measuring wheel (opisometer) diagram" class="kit-photo" loading="lazy" decoding="async">
            <p>Map wheel: roll along the route to measure distance.</p>
          </div>
        </div>
        <ul class="kit-list">
          <li><strong>Prepare</strong>: Note the map scale (e.g., 1:50,000 ‚Üí 1 cm = 500 m). If your wheel has adjustable scales, set it to match.</li>
          <li><strong>Zero the wheel</strong>: Set the counter to 0 (or mark the starting reading).</li>
          <li><strong>Trace the route</strong>: Roll the wheel carefully along the road/river/trail. Keep steady pressure and stay on the line.</li>
          <li><strong>Read & convert</strong>:
            <ul>
              <li>If the wheel shows <em>map units</em> (e.g., centimeters), convert with the scale. Example: 12.6 cm at 1:50,000 ‚Üí 12.6 √ó 500 m = 6.3 km.</li>
              <li>If the wheel shows <em>direct distance</em> (scale dial), read kilometers/miles directly.</li>
            </ul>
          </li>
          <li><strong>Accuracy tips</strong>: Break long routes into segments; average two passes; avoid pressing too hard; recheck tight corners.</li>
          <li><strong>Alternatives</strong> (no wheel):
            <ul>
              <li><em>String method</em>: Lay thread along the route, straighten, then measure against the scale bar.</li>
              <li><em>Dividers/compass step-off</em>: Set to a known map distance (e.g., 1 km), walk it along the route counting steps.</li>
            </ul>
          </li>
          <li><strong>Formula</strong>: Real distance = Map distance √ó scale factor. At 1:25,000 ‚Üí 1 cm = 250 m; at 1:100,000 ‚Üí 1 cm = 1 km.</li>
          <li><strong>Note on projection</strong>: Over small areas most maps are fine; on very large distances, projections can distort measurements.</li>
        </ul>
      </section>

      <section class="kit-section" id="natural-nav">
        <h2>3) Finding North from Nature</h2>
        <ul class="kit-list">
          <li><strong>Shadow-stick (daytime)</strong>:
            <ol>
              <li>Stick in ground; mark the tip of the shadow (point A). Wait 10‚Äì15 minutes; mark the new tip (point B).</li>
              <li>Line A‚ÜíB runs roughly <em>West ‚Üí East</em>. Stand with A on your left, B on your right: you now face <em>North</em>.</li>
            </ol>
          </li>
          <li><strong>Sun method</strong>: In the Northern Hemisphere, the sun is due south at local solar noon; shadows point north.
            <ul>
              <li>Use timeanddate.com to estimate solar noon for your location.</li>
            </ul>
          </li>
          <li><strong>Night (Polaris)</strong>: Find the Big Dipper; trace a line from the two bowl edge stars ~5√ó that distance to Polaris ‚Äî that‚Äôs near true north.</li>
          <li><strong>Improvised compass</strong>: Magnetize a needle (rub on silk/hair 50‚Äì100√ó), place on a leaf over still water ‚Äî it will align roughly N‚ÄìS; red-mark one end beforehand.</li>
          <li><strong>Reality check</strong>: Moss growth, tree branches, and ant hills are unreliable on their own ‚Äî use multiple indicators.</li>
        </ul>
      </section>

      <section class="kit-section" id="errors-safety">
        <h2>4) Common Errors & Safety</h2>
        <ul class="kit-list">
          <li>Keep the compass level; avoid metal objects, phones, and knives near the needle.</li>
          <li>Account for <strong>declination</strong> every time you convert between field and map bearings.</li>
          <li>Use distant aiming points and frequent checks to avoid drift in low visibility.</li>
          <li>Always carry a backup: spare compass, whistle, headlamp, paper maps in a dry bag.</li>
        </ul>
      </section>

      <section class="kit-section" id="quick-ref">
        <h2>5) Quick Reference (Printable)</h2>
        <ul class="kit-list">
          <li>True = Magnetic + E (or ‚àí W). Cairo ~ +3¬∞E (verify current data).</li>
          <li>Triangulation: two back-bearings (¬±180¬∞) ‚Üí intersection = your position.</li>
          <li>Shadow-stick: first mark (W), second mark (E) ‚Üí face north with W left, E right.</li>
          <li>Night: Big Dipper bowl edge ‚Üí 5√ó to Polaris (north).</li>
        </ul>
      </section>

      <section class="kit-section" id="resources">
        <h2>Authoritative Resources</h2>
        <ul>
          <li><a href="https://www.ngdc.noaa.gov/geomag/calculators/magcalc.shtml" target="_blank" rel="noopener">NOAA Magnetic Declination Calculator</a></li>
 
        </ul>
        <p><a href="index.html">‚Üê Back to the Human Continuity Blueprint</a></p>
      </section>
    </article>
  </main>

  <footer class="site-footer">
    <div class="wrap" data-i18n="footer.navigation">Field Navigation Guide ‚Äî Part of the Human Continuity Blueprint ‚Ä¢ Developed by Hazem ElBatawy</div>
  </footer>
  <div class="accessibility-widget" role="region" aria-label="Accessibility controls">
    <div class="row">
      <button id="tts-play" title="Read aloud">‚ñ∂ Read</button>
      <button id="tts-pause" title="Pause/Resume">‚è∏ Pause</button>
      <button id="tts-stop" title="Stop reading">‚èπ Stop</button>
    </div>
    <div class="row">
      <label for="tts-rate">Speed</label>
      <input id="tts-rate" type="range" min="0.8" max="1.4" step="0.1" value="1.0" aria-label="Reading speed">
    </div>
    <div class="row">
      <label for="tts-voice">Voice</label>
      <select id="tts-voice" aria-label="Voice"></select>
      <button id="tts-selection" title="Read selected text">Read selection</button>
    </div>
    <div class="row">
      <button id="reader-mode" title="Toggle reader mode">üÖ° Reader</button>
      <button id="font-plus" title="Increase font size">A+</button>
      <button id="font-minus" title="Decrease font size">A-</button>
    </div>
    <div class="row tts-status" aria-live="polite"></div>
  </div>
  <script src="assets/js/lang-switcher.js" defer></script>
  <script src="assets/js/accessibility.js" defer></script>
  <!-- Prefer local bundle for offline-first; fallback to CDN if unavailable -->
  <script src="assets/js/vendor/html2pdf.bundle.min.js" defer></script>
  <script>
    // Fallback: if local html2pdf isn't present (first-run), load from CDN
    (function(){
      function ensureHtml2Pdf(cb){
        if (window.html2pdf) { cb && cb(); return; }
        var s = document.createElement('script');
        s.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js';
        s.crossOrigin = 'anonymous';
        s.referrerPolicy = 'no-referrer';
        s.onload = function(){ cb && cb(); };
        document.head.appendChild(s);
      }
      // Expose for the PDF buttons script below
      window.__ensureHtml2Pdf = ensureHtml2Pdf;
    })();
  </script>
  <script>
    // Register service worker for offline caching (requires serving over http/https)
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js').catch(() => {});
    }
    (function() {
      function generatePDF(targetSelector, filename) {
        const el = document.querySelector(targetSelector);
        if (!el) {
          console.error('PDF target element not found:', targetSelector);
          return;
        }
        
        const opt = {
          margin: 0.5,
          filename: filename || 'download.pdf',
          image: { type: 'jpeg', quality: 0.95 },
          html2canvas: { 
            scale: 2, 
            useCORS: true, 
            logging: true, 
            backgroundColor: '#ffffff',
            allowTaint: true,
            letterRendering: true,
            width: 800,
            height: null
          },
          jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
        };
        
        function buildPdfLinksBlock(items){
          const wrap = document.createElement('section');
          wrap.className = 'kit-section';
          wrap.style.cssText = 'background: #ffffff; padding: 20px; margin: 20px 0; border: 1px solid #ddd;';
          const h = document.createElement('h2'); 
          h.textContent = 'Useful Links'; 
          h.style.cssText = 'color: #333; margin-bottom: 15px; font-size: 18px;';
          wrap.appendChild(h);
          const ul = document.createElement('ul'); 
          ul.className = 'kit-list';
          ul.style.cssText = 'list-style-type: disc; padding-left: 20px;';
          items.forEach(({text, href}) => { 
            const li = document.createElement('li'); 
            li.style.cssText = 'margin-bottom: 8px;';
            const a = document.createElement('a'); 
            a.href = href; 
            a.textContent = text;
            a.style.cssText = 'color: #0645ad; text-decoration: underline;';
            li.appendChild(a); 
            ul.appendChild(li); 
          });
          wrap.appendChild(ul);
          return wrap;
        }
        
        function run(){
          console.log('Starting PDF generation for:', targetSelector);
          document.body.classList.add('pdf-export');
          
          // Create container with proper styling
          const temp = document.createElement('div'); 
          temp.style.cssText = 'position: absolute; left: -10000px; top: 0; width: 800px; background: #ffffff; padding: 20px; font-family: Arial, sans-serif; font-size: 14px; line-height: 1.4; color: #333;';
          
          // Clone the target element
          const clone = el.cloneNode(true);
          
          // Ensure all content is visible and styled for PDF
          const allElements = clone.querySelectorAll('*');
          allElements.forEach(element => {
            const computed = window.getComputedStyle(element);
            if (computed.display === 'none' || computed.visibility === 'hidden') {
              element.style.display = 'block';
              element.style.visibility = 'visible';
            }
            element.style.color = element.style.color || '#333';
            element.style.backgroundColor = element.style.backgroundColor || 'transparent';
          });
          
          // Style the cloned content
          clone.style.cssText = 'width: 100%; background: #ffffff; padding: 0; margin: 0;';
          
          // Add links section
          const links = [
            { text: 'Home Page', href: 'index.html' },
            { text: 'War Survival Kit', href: 'survival-kit.html' },
            { text: 'Egypt Map Page', href: 'egypt.html' }
          ];
          clone.appendChild(buildPdfLinksBlock(links));
          
          temp.appendChild(clone);
          document.body.appendChild(temp);
          
          console.log('Element content for PDF:', temp.innerHTML.length, 'characters');
          
          const worker = window.html2pdf().set(opt).from(temp).save();
          
          const cleanup = () => { 
            document.body.classList.remove('pdf-export'); 
            if (temp.parentNode) temp.remove(); 
            console.log('PDF generation completed and cleaned up');
          };
          
          if (worker && typeof worker.then === 'function') {
            worker.then(cleanup).catch((error) => {
              console.error('PDF generation error:', error);
              cleanup();
            });
          } else {
            setTimeout(cleanup, 2000);
          }
        }
        
        if (!window.html2pdf && window.__ensureHtml2Pdf) {
          console.log('Loading html2pdf library...');
          window.__ensureHtml2Pdf(run);
        } else {
          run();
        }
      }
      document.addEventListener('click', function(e) {
        const btn = e.target.closest('button[data-pdf-target]');
        if (!btn) return;
        const sel = btn.getAttribute('data-pdf-target');
        const name = btn.getAttribute('data-filename');
        generatePDF(sel, name);
      });
    })();
    
    // Background slideshow management
    document.addEventListener('DOMContentLoaded', function() {
      const images = document.querySelectorAll('.bg-slideshow img');
      let current = 0;
      
      function nextImage() {
        if (images.length > 1) {
          images[current].classList.remove('active');
          current = (current + 1) % images.length;
          images[current].classList.add('active');
        }
      }
      
      // Change image every 10 seconds
      if (images.length > 1) {
        setInterval(nextImage, 10000);
      }
      
      // Enhanced mobile background fix
      function forceMobileResize() {
        if (window.innerWidth <= 768) {
          const bgSlideshow = document.querySelector('.bg-slideshow');
          const bgImages = document.querySelectorAll('.bg-slideshow img');
          
          if (bgSlideshow) {
            bgSlideshow.style.cssText = `
              position: fixed !important;
              top: 0 !important;
              left: 0 !important;
              width: 100vw !important;
              height: 100vh !important;
              overflow: hidden !important;
              z-index: -1 !important;
              background-color: #0a0e17 !important;
            `;
          }
          
          bgImages.forEach(img => {
            const isActive = img.classList.contains('active');
            img.style.cssText = `
              position: absolute !important;
              top: 0 !important;
              left: 0 !important;
              width: 100vw !important;
              height: 100vh !important;
              object-fit: cover !important;
              object-position: center center !important;
              transform: none !important;
              transition: opacity 2s ease-in-out !important;
              opacity: ${isActive ? '0.4' : '0'} !important;
              pointer-events: none !important;
            `;
          });
          
          // Prevent body overflow and ensure proper mobile layout
          document.body.style.overflowX = 'hidden';
          document.body.style.maxWidth = '100vw';
          
          // Enhance content readability on mobile
          const main = document.querySelector('main');
          if (main) {
            main.style.cssText = `
              background: rgba(11, 18, 32, 0.85) !important;
              backdrop-filter: blur(8px) !important;
              margin: 10px !important;
              padding: 15px !important;
              border-radius: 8px !important;
            `;
          }
        }
      }
      
      // Apply mobile fixes
      forceMobileResize();
      window.addEventListener('orientationchange', function() {
        setTimeout(forceMobileResize, 100);
      });
      window.addEventListener('resize', forceMobileResize);
    });
  </script>
</body>
</html>
